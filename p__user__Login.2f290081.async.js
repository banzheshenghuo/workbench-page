(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[531],{34687:function(C){C.exports={container:"container___1sYa-",content:"content___2zk1-",icon:"icon___rzGKO"}},68940:function(C,P,a){"use strict";a.r(P),a.d(P,{default:function(){return w}});var se=a(18106),Z=a(57910),re=a(34792),y=a(48086),d=a(11849),v=a(3182),T=a(2824),te=a(17462),b=a(76772),G=a(94043),o=a.n(G),O=a(89366),I=a(2603),D=a(29985),N=a(67294),Y=a(83039),B=a(5966),K=a(16434),R=a(63434),t=a(25377),V=a(92002),W=a(5029);function J(M,p){return S.apply(this,arguments)}function S(){return S=(0,v.Z)(o().mark(function M(p,m){return o().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,t.WY)("/api/login/captcha",(0,d.Z)({method:"GET",params:(0,d.Z)({},p)},m||{})));case 1:case"end":return h.stop()}},M)})),S.apply(this,arguments)}var Q=a(34687),f=a.n(Q),e=a(85893),A=function(p){var m=p.content;return(0,e.jsx)(b.Z,{style:{marginBottom:24},message:m,type:"error",showIcon:!0})},X=function(){var p=(0,N.useState)({}),m=(0,T.Z)(p,2),L=m[0],h=m[1],k=(0,N.useState)("account"),U=(0,T.Z)(k,2),x=U[0],q=U[1],z=(0,t.tT)("@@initialState"),F=z.initialState,_=z.setInitialState,l=(0,t.YB)(),ee=function(){var c=(0,v.Z)(o().mark(function n(){var u,i;return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,F==null||(u=F.fetchUserInfo)===null||u===void 0?void 0:u.call(F);case 2:if(i=s.sent,!i){s.next=6;break}return s.next=6,_(function(j){return(0,d.Z)((0,d.Z)({},j),{},{currentUser:i})});case 6:case"end":return s.stop()}},n)}));return function(){return c.apply(this,arguments)}}(),ae=function(){var c=(0,v.Z)(o().mark(function n(u){var i,g,s,j,$;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,W.x4)((0,d.Z)((0,d.Z)({},u),{},{type:x}));case 3:if(i=r.sent,i.status!=="ok"){r.next=15;break}return g=l.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),y.ZP.success(g),r.next=9,ee();case 9:if(t.m8){r.next=11;break}return r.abrupt("return");case 11:return s=t.m8.location.query,j=s.redirect,t.m8.push(j||"/"),r.abrupt("return");case 15:console.log(i),h(i),r.next=23;break;case 19:r.prev=19,r.t0=r.catch(0),$=l.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),y.ZP.error($);case 23:case"end":return r.stop()}},n,null,[[0,19]])}));return function(u){return c.apply(this,arguments)}}(),E=L.status,H=L.type;return(0,e.jsxs)("div",{className:f().container,children:[(0,e.jsx)("div",{className:f().content,children:(0,e.jsxs)(Y.U,{logo:(0,e.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:"\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF",initialValues:{autoLogin:!0},onFinish:function(){var c=(0,v.Z)(o().mark(function n(u){return o().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,ae(u);case 2:case"end":return g.stop()}},n)}));return function(n){return c.apply(this,arguments)}}(),children:[(0,e.jsxs)(Z.Z,{activeKey:x,onChange:q,children:[(0,e.jsx)(Z.Z.TabPane,{tab:l.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},"account"),(0,e.jsx)(Z.Z.TabPane,{tab:l.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})},"mobile")]}),E==="error"&&H==="account"&&(0,e.jsx)(A,{content:l.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),x==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(B.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(O.Z,{className:f().prefixIcon})},placeholder:l.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,e.jsx)(t._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(B.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(I.Z,{className:f().prefixIcon})},placeholder:l.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,e.jsx)(t._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),E==="error"&&H==="mobile"&&(0,e.jsx)(A,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),x==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(B.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(D.Z,{className:f().prefixIcon})},name:"mobile",placeholder:l.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(t._H,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(t._H,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(K.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(I.Z,{className:f().prefixIcon})},captchaProps:{size:"large"},placeholder:l.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(n,u){return n?"".concat(u," ").concat(l.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):l.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,e.jsx)(t._H,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var c=(0,v.Z)(o().mark(function n(u){var i;return o().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,J({phone:u});case 2:if(i=s.sent,i!==!1){s.next=5;break}return s.abrupt("return");case 5:y.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return s.stop()}},n)}));return function(n){return c.apply(this,arguments)}}()})]}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(R.Z,{noStyle:!0,name:"autoLogin",children:(0,e.jsx)(t._H,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,e.jsx)("a",{style:{float:"right"},children:(0,e.jsx)(t._H,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})}),(0,e.jsx)(V.Z,{})]})},w=X}}]);
